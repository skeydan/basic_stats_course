---  
title: Discrete Probability Distributions
output: 
  html_document
---
  
  
## Random Variables and Probability Distributions

* A random variable models the numerical outcome of an experiment
* Random variables come in two flavours:
    + discrete: can take on only a countable number of possibilities
    + continuous: can take any value on [a subset of] the real number line 
* Discrete random variables have probability mass functions
    + every possible outcome is assigned a probability
* Continuous random variables have probability density functions
    + probability at any given _point_ is 0, can only meaningfully specify probabilities for _intervals_

## Discrete Probability Distributions


### Bernoulli Distribution

* outcome is binary with values 0 or 1
* p = probability of success (1)
* examples: coin flips, rain vs. no rain, ...

$$P(X = x) =  p^x (1 - p)^{1 - x}$$

```{r}
# generate 10 bernoulli random variables with p=0.5
rbinom(10,1,0.5)
```

```{r}
# generate 10 bernoulli random variables with p=0.2
rbinom(10,1,0.2)
```

&nbsp;

### Binomial distribution

* sum of IID (independent and identically distributed) Bernoulli trials
* examples: number of tails in 5 coin flips, number of leads closed, ...
* n = number of trials, k = number of successes, p = probability of success

$$P(X = x) = 
\left(
\begin{array}{c}
  n \\ x
\end{array}
\right)
p^x(1 - p)^{n-x}$$

```{r}
# generate 10 binomial random variables with 10 trials, p=0.2
rbinom(10,10,0.2)
```

```{r}
# generate 10 binomial random variables with 10 trials, p=0.9
rbinom(10,10,0.9)
```

```{r}
#How likely is it to obtain 4 success in 6 trials when p=0.1?
dbinom(4,6,0.1)
```

```{r, warning=FALSE, message=FALSE}
library(ggplot2)
library(dplyr)
library(gridExtra)

# Plot various binomial distributions
n <- 10
k <- seq(0,10,1)
p1 <- 0.1
prob1 <- dbinom(k,n,p1)
p3 <- 0.3
prob3 <- dbinom(k,n,p3)
p5 <- 0.5
prob5 <- dbinom(k,n,p5)
p9 <- 0.9
prob9 <- dbinom(k,n,p9)
g1 <- ggplot(data_frame(x = k, y1 = prob1)) + geom_bar(aes(x = k, y = prob1), stat="identity", fill="blue") +
  ylab("p = 0.1")
g3 <- ggplot(data_frame(x = k, y1 = prob3)) + geom_bar(aes(x = k, y = prob3), stat="identity", fill="green") +
  ylab("p = 0.3")
g5 <- ggplot(data_frame(x = k, y1 = prob5)) + geom_bar(aes(x = k, y = prob5), stat="identity", fill="violet") +
  ylab("p = 0.5")
g9 <- ggplot(data_frame(x = k, y1 = prob9)) + geom_bar(aes(x = k, y = prob9), stat="identity", fill="cyan") +
  ylab("p = 0.9")
grid.arrange(g1,g3,g5,g9, ncol=2, nrow=2, top="Binomial distributions for different p")
```


### Poisson distribution

* used to model counts
* examples: number of add clicks per time interval, number of laptop crashes, ...
* with n very large and p very small, is an accurate approximation of the binomial distribution
* $\lambda$ = mean and variance of the distribution (see later)

$$P(X = x; \lambda) = \frac{\lambda^x e^{-\lambda}}{x!}$$

```{r, warning=FALSE, message=FALSE}
# Plot various Poisson distributions
n <- 10
k <- seq(0,20,1)
lambda1 <- 1
prob1 <- dpois(k,lambda1)
lambda2 <- 2
prob2 <- dpois(k,lambda2)
lambda4 <- 4
prob4 <- dpois(k,lambda4)
lambda10 <- 10
prob10 <- dpois(k,lambda10)
g1 <- ggplot(data_frame(x = k, y1 = prob1)) + geom_bar(aes(x = k, y = prob1), stat="identity", fill="blue") +
  ylab("lambda = 1")
g3 <- ggplot(data_frame(x = k, y1 = prob2)) + geom_bar(aes(x = k, y = prob2), stat="identity", fill="green") +
  ylab("lambda = 2")
g5 <- ggplot(data_frame(x = k, y1 = prob4)) + geom_bar(aes(x = k, y = prob4), stat="identity", fill="violet") +
  ylab("lambda = 4")
g9 <- ggplot(data_frame(x = k, y1 = prob10)) + geom_bar(aes(x = k, y = prob10), stat="identity", fill="cyan") +
  ylab("lambda = 10")
grid.arrange(g1,g3,g5,g9, ncol=2, nrow=2, top="Poisson distributions for different lambda")
```

Use Poisson to model rates over time:

* $t$ = total elapsed time
* expected count per unit of time: $\lambda = E[X / t]$ 
* distribution: $X \sim Poisson(\lambda t)$

Example:

* cars approaching motorway exit <fill in your favorite bottleneck location here>
* number of cars arriving per minute (on average): 12
* What is the probability that exactly 0 cars arrive in one minute? 

```{r}
dpois(0, lambda=12)
```

* Let's observe for 10 minutes in total
* What is the probability that fewer than 40 cars arrive during these 10 minutes? 

```{r}
ppois(80, lambda=12*10)
```

